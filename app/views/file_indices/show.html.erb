<% content_for 'head' do %>
	<%= stylesheet_link_tag 'filetree' %>
<% end %>

<% content_for 'sub_menu' do %>
	<ul id="sub_menu">
			<li><%= link_to 'View Host', host_path(@host_id) %></li>
	</ul>
<% end %>

<h2>Snapshot: <%= @file_index.snapname.gsub!(/_/," ") if @file_index.snapname %></h2>

<% form_for :file_index, @file_index, :url => get_file_index_host_restore_schedule_file_indices_path(@host_id, @restore.id, @schedule_id) do |f| %>
	<%= f.label "Select Backup To Browse"%>
	<%= f.collection_select(:id, @file_indices, :id, :snapname) %>
	<%= f.submit('Go') %>
<% end %>

<div class="filetree">
	<div class='current_dir'><%= @current_dir %></div>
	<ul class="filetree">
		<% if @current_dir != "/" %>
			<li class="directory collapsed">	
				<%= link_to 'Parent Directory', 
					host_restore_schedule_file_index_path(@host_id, 
						@restore.id, 
						@schedule_id, 
						@file_index.id, 
						:dir => File.dirname(@current_dir)
					) 
				%>
			</li>
		<% end %>
	  <% @dirs_files[0].each do |dir| %>
			<li class="directory collapsed">
				<%= link_to image_tag('add.png'), 
					add_host_restore_schedule_file_index_path(
							@host_id, 
							@restore.id, 
							@schedule_id, 
							@file_index.id,
							:dir => @current_dir,
							:item => dir
						) 
				%>
				<%= link_to dir, host_restore_schedule_file_index_path(
					@host_id, 
					@restore.id, 
					@schedule_id, 
					@file_index.id, 
					:dir => "#{@current_dir}/#{dir}" 
				) %>
			</li>
	  <% end %>
		<% @dirs_files[1].each do |file| %>
	    <li class="file ext_<%=File.extname(file)[1..-1]%>">
				<%= link_to image_tag('add.png'),
				 		add_host_restore_schedule_file_index_path(
							@host_id, 
							@restore.id, 
							@schedule_id, 
							@file_index.id,
							:dir => @current_dir,
							:item => file
						)
				%>
				<%= file %>
			</li>
	  <% end %>
	</ul>
</div>

<div class="restore_set">
	<% if @restore.data %>
		<table>
			<th>Snapshot</th>
			<th>Item</th>
			<% @restore.data.each do |item| %>
				<tr>
					<td><%= item.keys.first.gsub(/_/," ") %></td>
					<td><%= item.values.first %></td>
				</tr>
			<% end %>
		</table>
	<% end %>
</div>
<div class="clear"></div>